<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spi_arduino_master &mdash; spi_arduino_master 1.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c55cb9cb"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            spi_arduino_master
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">spi_arduino_master</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">spi_arduino_master</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for spi_arduino_master</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===================</span>
<span class="sd">spi_arduino_master</span>
<span class="sd">===================</span>

<span class="sd">SPI master with Arduino. Has 2 implementations/structures:</span>

<span class="sd">1: Compatible with SDK spi_slave controller generated files. Outputs of spli_slave controller can be connected to the input IOs. This entity will go once trhough the IO files and write them to Arduino&#39;s pins and retur miso. Aclso can be se to read and write to txt files by setting self.read_from to &quot;file&quot; instead of &quot;IOs&quot;. Entity is used by self.run() function. One values/line is red from IOs/file and written straight to Arduino&#39;s pins and miso ir read.</span>

<span class="sd">2: Do not requires of running self.run() function but instead is used by 2 separate functions: writeToMem(self,conf), pushConf(self,conf). </span>

<span class="sd">In Arduino swithc between structure is done by commenting and uncommenting corresponding parts.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1">#if not (os.path.abspath(&#39;../../thesdk&#39;) in sys.path):</span>
<span class="c1">#    sys.path.append(os.path.abspath(&#39;../../thesdk&#39;))</span>

<span class="c1">#from thesdk import *</span>
<span class="c1">#from rtl import *</span>
<span class="c1">#from spice import *</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">serial</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pdb</span>



<span class="c1">#class spi_arduino_master(thesdk):</span>
<div class="viewcode-block" id="spi_arduino_master">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master">[docs]</a>
<span class="k">class</span> <span class="nc">spi_arduino_master</span><span class="p">():</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_classfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="vm">__name__</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span> 
        <span class="c1">#self.print_log(type=&#39;I&#39;, msg=&#39;Inititalizing %s&#39; %(__name__)) </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proplist</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;Rs&#39;</span> <span class="p">];</span>    <span class="c1"># Properties that can be propagated from parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rs</span> <span class="o">=</span>  <span class="mf">100e6</span><span class="p">;</span>            <span class="c1"># Sampling frequency</span>
        <span class="c1">#self.IOS=Bundle()</span>
        <span class="c1">#self.IOS.Members[&#39;sclk&#39;]=IO() # Pointer for input data</span>
        <span class="c1">#self.IOS.Members[&#39;cs&#39;]=IO() # Pointer for input data:w</span>
        <span class="c1">#self.IOS.Members[&#39;miso&#39;]=IO()       # Pointer for input data</span>
        <span class="c1">#self.IOS.Members[&#39;mosi&#39;]=IO()       # Pointer for input data</span>
        <span class="c1">#self.IOS.Members[&#39;time&#39;]=IO()       # Pointer for input data</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_from</span> <span class="o">=</span> <span class="s2">&quot;IOs&quot;</span>   <span class="c1"># IOs or file. IOs not tested</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_from</span> <span class="o">=</span> <span class="s2">&quot;file&quot;</span>   <span class="c1"># IOs or file. IOs not tested</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_in_path</span> <span class="o">=</span> <span class="s1">&#39;in1.txt&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">file_out_path</span> <span class="o">=</span> <span class="s1">&#39;out1.txt&#39;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">=</span><span class="mi">2</span> <span class="c1"># 1, 2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">const_time</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_step</span><span class="o">=</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_step_fact</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>       
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;py&#39;</span><span class="p">;</span>             <span class="c1"># Can be set externally, but is not propagated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">=</span> <span class="kc">False</span>              <span class="c1"># By default, no parallel processing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">=</span> <span class="p">[]</span>               <span class="c1"># By default, no parallel processing</span>
        <span class="c1">#Collects mosi, cs and sclk controlled by master</span>
        <span class="c1">#self.IOS.Members[&#39;control_write&#39;]= IO() </span>
        <span class="c1">#This is a placeholder, file is created by controller</span>
        <span class="c1">#_=rtl_iofile(self,name=&#39;control_write&#39;, dir=&#39;in&#39;, iotype=&#39;event&#39;, ionames=[&#39;reset&#39;, &#39;initdone&#39;, &#39;io_cs&#39;, &#39;io_mosi&#39;, &#39;io_sclk&#39;])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span> <span class="o">=</span> <span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/ttyACM0&#39;</span><span class="p">,</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> 
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">copy_propval</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">proplist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span><span class="n">parent</span><span class="p">;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<div class="viewcode-block" id="spi_arduino_master.init">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.init">[docs]</a>
    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

        <span class="c1">### Lets fix this later on</span>
        <span class="c1">#if self.model==&#39;vhdl&#39;:</span>
        <span class="c1">#    self.print_log(type=&#39;F&#39;, msg=&#39;VHDL simulation is not supported with v1.2\n Use v1.1&#39;)</span>
<div class="viewcode-block" id="spi_arduino_master.write_read">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.write_read">[docs]</a>
    <span class="k">def</span> <span class="nf">write_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Functions takes string of an integer that represets value of sclk, mosi and cs and updates given values to Arduino&#39;s pins while reading and returning miso pin.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">            x : string</span>
<span class="sd">                string of integer,  &quot;4&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
        <span class="n">d</span><span class="o">=</span><span class="n">arduino</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>




<div class="viewcode-block" id="spi_arduino_master.writeToMem">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.writeToMem">[docs]</a>
    <span class="k">def</span> <span class="nf">writeToMem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">conf</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Functions takes binary string (big endian) as a &quot;conf&quot; parameter and writes that configure string to Arduino&#39;s memory.</span>

<span class="sd">            Parameters</span>
<span class="sd">            -----------</span>
<span class="sd">            conf : string</span>
<span class="sd">                binary string (big endian),  &quot;010101101&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#pdb.set_trace()</span>
        <span class="n">conf_len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
        <span class="n">bytes_num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">conf_array</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">bytes_num</span><span class="p">)</span>
        <span class="c1">#conf_array[0]=&#39;w&#39;</span>
        <span class="n">z</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bytes_num</span><span class="o">*</span><span class="mi">8</span><span class="o">-</span><span class="n">conf_len</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)))</span>
        <span class="n">conf</span><span class="o">=</span> <span class="n">z</span><span class="o">+</span><span class="n">conf</span>
        <span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1">#d=self.arduino.write(bytes(&#39;w&#39;, &#39;utf-8&#39;))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">bytes_num</span><span class="p">):</span>
            <span class="c1">#pdb.set_trace()</span>
            <span class="n">test</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">data</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">conf</span><span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span><span class="mi">2</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">conf_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="c1">#conf_array[i]=&#39;&#39;.join([chr(int(test,2))])</span>

        <span class="c1">#pdb.set_trace()</span>
        <span class="n">w</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">conf_array</span><span class="p">:</span>
            
            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="c1">#self.arduino.flush()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="c1">#self.arduino.flush()</span>
        <span class="c1">#    self.arduino.write(x.encode())  # Send the 20-bit string to Arduino</span>
        <span class="c1">#    self.arduino.flush()</span>
        <span class="c1">#    pdb.set_trace()</span>
        <span class="c1">#self.arduino.write(conf_array)  # Send the 20-bit string to Arduino</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c1">#pdb.set_trace()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#pdb.set_trace()</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">in_waiting</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">in_waiting</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For some reason sometimes writing fails, try again. Sorry&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>

        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">in_waiting</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="c1">#d=self.arduino.write(bytes(conf_array))</span>
        <span class="c1">#d=self.arduino.write(bytes(conf_array, &#39;utf-8&#39;))</span>

        <span class="n">a</span><span class="o">=</span><span class="mi">5</span></div>


<div class="viewcode-block" id="spi_arduino_master.pushConf">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.pushConf">[docs]</a>
    <span class="k">def</span> <span class="nf">pushConf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">conf</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Function pushed configure string from Arduino&#39;s memory to pins and reads miso intput to memory. After whole configure string is sent to pins, miso string is returned from Arduino to return valuae of the function. This function requires same configure string as a &quot;conf&quot; parameter as writeToMem(self,conf) in order to know the expected number of bytes.</span>

<span class="sd">         Parameters</span>
<span class="sd">         ----------</span>
<span class="sd">         conf : string</span>
<span class="sd">            binary string (big endian),  &quot;010101101&quot;</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conf_len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
        <span class="n">bytes_num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">mon_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bytes_num</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">reset_input_buffer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c1">#pdb.set_trace()</span>

        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">in_waiting</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1">#pdb.set_trace()</span>
                <span class="n">test</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">test</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;a&#39;</span><span class="p">:</span>
                    <span class="c1">#self.arduino.read(2)</span>
                    <span class="k">break</span>

                 

        <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">in_waiting</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">mon_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>

            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">bytes_num</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1">#x= self.arduino.read(size=3)</span>
        <span class="c1">#y=&#39;&#39;.join(format(byte,&#39;08b&#39;) for byte in x)</span>


        <span class="c1">#d=self.arduino.write(bytes(&#39;p&#39;, &#39;utf-8&#39;))</span>

        <span class="c1">#mon_array = self.arduino.read(size=bytes_num)</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mon_array</span><span class="p">:</span>
            <span class="n">monitor</span><span class="o">=</span><span class="n">monitor</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">binary_repr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">monitor</span><span class="o">=</span><span class="n">monitor</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arduino</span><span class="o">.</span><span class="n">reset_input_buffer</span><span class="p">()</span>
        <span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
        <span class="n">a</span><span class="o">=</span><span class="mi">5</span>
        <span class="k">return</span> <span class="n">monitor</span></div>


<div class="viewcode-block" id="spi_arduino_master.main">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.main">[docs]</a>
    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span> 
            <span class="n">const_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">const_time</span>
            <span class="n">time_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_step</span>
            <span class="n">time_step_fact</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span> <span class="n">time_step_fact</span>                 
            <span class="c1">#pdb.set_trace() </span>
            <span class="c1">#print(arduino.readline())</span>
            <span class="c1">#time.sleep(0.1)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
                <span class="n">first_line</span><span class="o">=</span><span class="kc">True</span>
                <span class="n">prev_time</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;in1.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f2</span><span class="p">:</span>
                    <span class="n">start_time</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">const_time</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                            <span class="n">time_step</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">prev_time</span>
                        <span class="n">prev_time</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">data</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])),</span><span class="mi">2</span><span class="p">))</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">time_step</span><span class="o">*</span><span class="n">time_step_fact</span><span class="p">)</span>
                        <span class="c1">#num = input(&quot;Enter a number: &quot;) # Taking input from user</span>
                        <span class="c1">#if int(num) ==int(5):</span>
                        <span class="c1">#    </span>
                        <span class="n">time_r1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">time_r2</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writetime=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">time_r2</span><span class="o">-</span><span class="n">time_r1</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">)))</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="c1"># printing the valueerial</span>
                        <span class="n">f2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">prev_time</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">stoptime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">((</span><span class="n">stoptime</span><span class="o">-</span><span class="n">start_time</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from</span><span class="o">==</span><span class="s1">&#39;IOs&#39;</span><span class="p">:</span>
                <span class="c1"># Inputs</span>

                <span class="c1">#t=self.IOS.Members[&#39;time&#39;].Data</span>
                <span class="c1">#cs=self.IOS.Members[&#39;cs&#39;].Data</span>
                <span class="c1">#sclk=self.IOS.Members[&#39;sclk&#39;].Data</span>
                <span class="c1">#mosi=self.IOS.Members[&#39;mosi&#39;].Data</span>
                <span class="c1">#miso=np.zeros(len(t))</span>
                <span class="c1">#pdb.set_trace() </span>

                <span class="c1"># Test values</span>
                <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">cs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">cs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                <span class="n">sclk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">sclk</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span>
                <span class="n">mosi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">mosi</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">])]</span><span class="o">=</span><span class="mi">1</span>
                <span class="n">miso</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>


                <span class="c1"># Function starts</span>
                <span class="n">start_time</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                <span class="n">prev_time</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">sclk</span><span class="p">,</span><span class="n">mosi</span><span class="p">,</span><span class="n">cs</span><span class="p">)))</span><span class="c1"># .astype(str)</span>
                <span class="n">data_in</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="c1">#data_in=np.char.add(data[:,0],data[:,1])</span>
                <span class="c1">#data_in=np.char.add(data_in,data[:,2])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_in</span><span class="p">)):</span>

                    <span class="c1">#pdb.set_trace()</span>
                    <span class="k">if</span> <span class="n">const_time</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                        <span class="n">time_step</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">prev_time</span>
                    <span class="n">prev_time</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">time_step</span><span class="o">*</span><span class="n">time_step_fact</span><span class="p">)</span>
                    <span class="c1">#num = input(&quot;Enter a number: &quot;) # Taking input from user</span>
                    <span class="c1">#if int(num) ==int(5):</span>
                    <span class="c1">#    </span>
                    <span class="n">time_r1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">time_r2</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writetime=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">time_r2</span><span class="o">-</span><span class="n">time_r1</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">)))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="c1"># printing the valueerial</span>
                    <span class="n">miso</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
                <span class="n">stoptime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">((</span><span class="n">stoptime</span><span class="o">-</span><span class="n">start_time</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">))</span>

                <span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
                <span class="c1">#self.IOS.Members[&#39;miso&#39;].Data=miso</span>
                <span class="n">a</span><span class="o">=</span><span class="mi">5</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="c1">#pdb.set_trace()</span>
            <span class="n">conf_len</span><span class="o">=</span><span class="mi">20</span>
            <span class="n">bytes_num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">conf_len</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span>
            <span class="n">conf_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bytes_num</span><span class="p">)</span>
            <span class="n">mon_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">bytes_num</span><span class="p">)</span>
            <span class="n">conf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">conf_len</span><span class="p">)</span>
            <span class="c1">#conf[::2]=1</span>
            <span class="n">conf</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">conf</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)))</span>
            <span class="n">conf</span><span class="o">=</span><span class="s1">&#39;101000000000000000011111111&#39;</span>
            <span class="c1">#z=&#39;&#39;.join(map(str,np.zeros(bytes_num*8-conf_len).astype(int)))</span>
            <span class="c1">#conf= z+conf</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writeToMem</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">monitor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pushConf</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">monitor</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">monitor</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">conf</span><span class="p">):]</span><span class="o">==</span><span class="n">conf</span><span class="p">)</span>



            <span class="n">a</span><span class="o">=</span><span class="mi">5</span></div>

<div class="viewcode-block" id="spi_arduino_master.run">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.run">[docs]</a>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">=</span><span class="kc">True</span>      <span class="c1">#flag for parallel processing</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">=</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">#multiprocessing.queue as the first argument</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s1">&#39;py&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="spi_arduino_master.define_io_conditions">
<a class="viewcode-back" href="../index.html#spi_arduino_master.spi_arduino_master.define_io_conditions">[docs]</a>
    <span class="k">def</span> <span class="nf">define_io_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Input A is read to verilog simulation after &#39;initdone&#39; is set to 1 by controller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iofile_bundle</span><span class="o">.</span><span class="n">Members</span><span class="p">[</span><span class="s1">&#39;sclk&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">verilog_io_condition</span><span class="o">=</span><span class="s1">&#39;initdone&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iofile_bundle</span><span class="o">.</span><span class="n">Members</span><span class="p">[</span><span class="s1">&#39;miso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">verilog_io_condition</span><span class="o">=</span><span class="s1">&#39;initdone&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iofile_bundle</span><span class="o">.</span><span class="n">Members</span><span class="p">[</span><span class="s1">&#39;mosi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">verilog_io_condition</span><span class="o">=</span><span class="s1">&#39;initdone&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iofile_bundle</span><span class="o">.</span><span class="n">Members</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">verilog_io_condition</span><span class="o">=</span><span class="s1">&#39;initdone&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iofile_bundle</span><span class="o">.</span><span class="n">Members</span><span class="p">[</span><span class="s1">&#39;cs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">verilog_io_condition</span><span class="o">=</span><span class="s1">&#39;initdone&#39;</span></div>
</div>

        <span class="c1"># Output is read to verilog simulation when all of the utputs are valid, </span>
        <span class="c1"># and after &#39;initdo&#39; is set to 1 by controller</span>
        <span class="c1">#self.iofile_bundle.Members[&#39;cs&#39;].verilog_io_condition_append(cond=&#39;&amp;&amp; initdone&#39;)</span>
        <span class="c1"># In Cpol0 Cpha1 miso is read with falling edge of sclk</span>
        <span class="c1">#self.iofile_bundle.Members[&#39;miso&#39;].verilog_io_sync=&#39;@(negedge io_sclk)\n&#39;</span>
        <span class="c1">#self.iofile_bundle.Members[&#39;miso&#39;].verilog_io_condition_append(cond=&#39;&amp;&amp; initdone&#39;)</span>


<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1">#import matplotlib.pyplot as plt</span>
    <span class="c1">#from  spi_arduino_master import *</span>
    <span class="c1">#from  spi_arduino_master.controller import controller as spi_controller</span>
    <span class="kn">import</span> <span class="nn">pdb</span>
    

    <span class="n">duts</span><span class="o">=</span><span class="p">[</span><span class="n">spi_arduino_master</span><span class="p">()</span> <span class="p">]</span>
    <span class="c1">#pdb.set_trace()</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">duts</span><span class="p">:</span> 
        <span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 TheSyDeKick Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>